---
output:
  pdf_document:
    latex_engine: xelatex
---

# 探索性数据分析-奥林匹克 {#eda-olympics}

这是新疆2019年风电发电及其环境数据

## 导入数据

```{r out.width = '100%'}
library(readxl)
library(tidyverse)
library(knitr)
data <- read_excel("./data/新疆风电2019.xlsx")
# 仅选择前5列和前5行
data %>%
  select(1:5) %>% # 选择前5列
  head(5) %>%
  kable(caption = "新疆风电2019年数据")

# 数据清理
data <- data %>%
  mutate(
    时间 = ymd_hms(时间),         # 转换时间为日期时间格式
    month = month(时间, label = TRUE), # 提取月份
    hour = hour(时间)              # 提取小时
  )
```

## 可视化

先看看实际发电功率分布

```{r out.width = '100%'}
ggplot(data, aes(x = `实际发电功率（mw）`)) +
  geom_histogram(bins = 30, fill = "steelblue", color = "white") +
  labs(
    title = "实际发电功率分布",
    x = "实际发电功率（MW）",
    y = "频数"
  ) +
  theme_minimal()
```

分析

想研究环境对发电的影响，可以从时间、风速、湿度等方面研究

按小时可视化发电功率

```{r}
hourly_data <- data %>%
  group_by(hour) %>%
  summarise(avg_power = mean(`实际发电功率（mw）`, na.rm = TRUE))

ggplot(hourly_data, aes(x = hour, y = avg_power)) +
  geom_line(color = "darkorange", size = 1) +
  geom_point(color = "darkblue", size = 2) +
  labs(
    title = "一天中不同小时的平均发电功率",
    x = "小时",
    y = "平均发电功率（MW）"
  ) +
  theme_minimal()

```

分析

风速的分布

```{r}
ggplot(data, aes(x = `测风塔30m风速(m/s)`, fill = month)) +
  geom_density(alpha = 0.6) +
  scale_fill_brewer(palette = "Set3") +
  labs(
    title = "不同月份30米风速分布",
    x = "风速 (m/s)",
    y = "密度",
    fill = "月份"
  ) +
  theme_minimal()
```

分析
